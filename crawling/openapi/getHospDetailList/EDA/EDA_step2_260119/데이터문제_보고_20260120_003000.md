# 강남언니 입점 비교 EDA 데이터 문제 보고

> **작성 일시**: 2026-01-20 00:30  
> **문제**: 매칭 데이터에서 입점 업체 0건 확인

---

## 문제 상황

### 데이터 확인 결과
- **파일**: `병원데이터_결합완료_20260120_000249.csv`
- **총 건수**: 1,153건
- **`_merge` 컬럼 분포**:
  - `left_only`: 1,153건 (100%)
  - `both`: 0건 (0%)
  - `right_only`: 0건 (0%)

### 원인 분석
이전 매칭 작업 결과:
- 병원명 + 주소 매칭: **0건** (주소 형식 차이)
- 병원명만 매칭: **188건** (16.3%)

**문제**: 최종 저장된 결합 파일에는 병원명+주소 매칭 결과만 포함되어 있어, 입점 업체가 0건으로 표시됨.

---

## 해결 방안

### 옵션 1: 병원명만 매칭 재수행 ⭐⭐⭐ (추천)

**방법**:
```python
# 병원명만으로 매칭
merged_df = pd.merge(
    df1, 
    df2, 
    on='매칭_병원명',  # 주소 제외
    how='left',
    suffixes=('_file1', '_file2'),
    indicator=True
)
```

**장점**:
- 188건의 입점 업체 확보
- 빠른 구현
- 기존 매칭 로직 활용

**단점**:
- 동명이병원 가능성 (검증 필요)
- 주소 정보 불일치

---

### 옵션 2: 강남언니 원본 데이터 직접 사용 ⭐⭐

**방법**:
```python
# 1. 강남언니 데이터에서 병원명 리스트 추출
gangnam_df = pd.read_csv('gangnam_hospitals_detail_RESUME_20260105_041227.csv')
입점_병원명_list = gangnam_df['hospital_name'].unique()

# 2. 전체 병원 데이터에서 입점 여부 판단
df['입점여부'] = df['원본_병원명'].apply(
    lambda x: '입점' if x in 입점_병원명_list else '미입점'
)
```

**장점**:
- 간단하고 명확
- 동명이병원 문제 최소화 (강남구 내에서만 비교)

**단점**:
- 강남언니 데이터의 추가 정보 활용 불가
- 단순 입점 여부만 파악

---

### 옵션 3: 주소 기반 유사도 매칭 ⭐

**방법**:
```python
# 주소의 핵심 부분만 추출하여 매칭
df1['매칭_주소_간략'] = df1['원본_주소'].str.extract(r'(.*동)')
df2['매칭_주소_간략'] = df2['address'].str.extract(r'(.*동)')

# 병원명 + 간략 주소로 매칭
merged_df = pd.merge(
    df1, df2,
    on=['매칭_병원명', '매칭_주소_간략'],
    how='left'
)
```

**장점**:
- 주소 형식 차이 극복
- 더 정확한 매칭

**단점**:
- 구현 복잡도 증가
- 여전히 매칭률 낮을 가능성

---

## 권장 방안

### 단계별 접근

**1단계**: 옵션 2 (강남언니 원본 데이터 직접 사용)
- 빠르게 입점 여부 식별
- 기본 비교 분석 수행

**2단계**: 옵션 1 (병원명만 매칭)
- 강남언니 데이터의 추가 정보 활용
- 심화 분석 수행

**3단계**: 옵션 3 (필요시)
- 매칭률 향상 필요 시 적용

---

## 즉시 실행 가능한 코드

### 옵션 2 구현 (추천)

```python
import pandas as pd

# 1. 데이터 로드
전체_df = pd.read_csv('병원전체정보_결측치처리완료_20260119_233319.csv')
강남언니_df = pd.read_csv('gangnam_hospitals_detail_RESUME_20260105_041227.csv')

# 2. 강남언니 입점 병원명 리스트
입점_병원명 = 강남언니_df['hospital_name'].str.strip().str.replace(' ', '').unique()

# 3. 전체 데이터에 입점 여부 추가
전체_df['매칭_병원명'] = 전체_df['원본_병원명'].str.strip().str.replace(' ', '')
전체_df['입점여부'] = 전체_df['매칭_병원명'].apply(
    lambda x: '입점' if x in 입점_병원명 else '미입점'
)

# 4. 결과 확인
print(f"입점: {(전체_df['입점여부'] == '입점').sum()}건")
print(f"미입점: {(전체_df['입점여부'] == '미입점').sum()}건")

# 5. 저장
전체_df.to_csv('병원데이터_입점여부포함.csv', index=False, encoding='utf-8-sig')
```

---

**작성**: 2026-01-20 00:30  
**상태**: 사용자 의사결정 대기
