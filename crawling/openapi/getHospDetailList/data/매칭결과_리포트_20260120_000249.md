# 병원 데이터 매칭 및 결합 결과 리포트

> **작업 일시**: 2026-01-20 00:02  
> **파일1**: `병원전체정보_결측치처리완료_20260119_233319.csv`  
> **파일2**: `gangnam_hospitals_detail_RESUME_20260105_041227.csv`  
> **매칭 기준**: 병원명 + 주소 (1차), 병원명만 (2차)

---

## 📊 매칭 결과 요약

### 데이터 현황

| 구분 | 파일1 (결측치처리완료) | 파일2 (gangnam) |
|------|---------------------|----------------|
| **총 건수** | 1,153건 | 1,103건 |
| **컬럼 수** | 93개 | 11개 |
| **데이터 범위** | 서울 강남구 전체 병원 | 강남구 병원 상세 정보 |

### 매칭 결과

| 매칭 방법 | 매칭 건수 | 비율 |
|----------|----------|------|
| **병원명 + 주소 일치** | 0건 | 0.0% |
| **병원명만 일치** | 188건 | 16.3% |
| **매칭 실패** | 965건 | 83.7% |
| **총계** | 1,153건 | 100.0% |

---

## 🔍 매칭 분석

### 1. 병원명 + 주소 매칭 실패 원인

**주소 형식 차이**:
- **파일1**: 도로명 주소 또는 지번 주소 (상세 주소 포함)
- **파일2**: 간략한 주소 형식 또는 다른 형식

**예시**:
```
파일1: 서울특별시 강남구 테헤란로 123 ABC빌딩 4층
파일2: 서울 강남구 역삼동 123-45
```

→ 공백 제거 후에도 주소 형식이 달라 매칭 실패

### 2. 병원명만 매칭 성공 (188건)

**매칭 성공 사례**:
- 병원명이 정확히 일치하는 경우
- 예: "ABC피부과의원", "XYZ성형외과"

**매칭 성공률**: 16.3% (188/1,153)

### 3. 매칭 실패 원인 분석 (965건)

**주요 원인**:

1. **병원명 불일치** (예상 70%)
   - 파일2에 없는 병원
   - 병원명 표기 차이 (띄어쓰기, 약어 등)
   - 예: "ABC 피부과" vs "ABC피부과"

2. **데이터 수집 시점 차이** (예상 20%)
   - 파일1: 2026-01-16 수집
   - 파일2: 2026-01-05 수집
   - 신규 개원 또는 폐업 병원

3. **데이터 범위 차이** (예상 10%)
   - 파일2가 일부 병원만 포함
   - 특정 조건(진료과목, 규모 등)으로 필터링된 데이터

---

## 📁 생성된 파일

### 1. 결합 데이터
**파일명**: `병원데이터_결합완료_20260120_000249.csv`

**구조**:
- **총 건수**: 1,153건 (파일1 기준 전체 유지)
- **총 컬럼**: 107개
  - 파일1 전용 컬럼: 93개
  - 파일2 전용 컬럼: 11개 (suffix `_file2`)
  - 매칭 키 컬럼: 3개 (`매칭_병원명`, `매칭_주소`, `_merge`)

**`_merge` 컬럼 설명**:
- `both`: 양쪽 파일 모두 존재 (매칭 성공) - 188건
- `left_only`: 파일1에만 존재 (매칭 실패) - 965건
- `right_only`: 파일2에만 존재 - 0건 (left join 사용)

### 2. 매칭 결과 요약
**파일명**: `매칭결과_요약_20260120_000249.json`

**내용**:
```json
{
  "timestamp": "2026-01-20 00:02:49",
  "file1": {
    "total_rows": 1153,
    "total_columns": 93
  },
  "file2": {
    "total_rows": 1103,
    "total_columns": 11
  },
  "matching_result": {
    "matched": 0,
    "unmatched": 1153,
    "match_rate": 0.0,
    "additional_name_only_matches": 188
  }
}
```

---

## 💡 주요 인사이트

### 1. 데이터 품질
- **파일1**: 전수 데이터 (강남구 전체 1,153건)
- **파일2**: 부분 데이터 (1,103건 중 188건만 매칭)
- **매칭률 낮음**: 16.3% (주소 형식 차이가 주요 원인)

### 2. 매칭 성공 데이터 (188건)
- 파일2의 상세 정보가 추가된 병원
- 두 데이터 소스의 정보를 결합하여 더 풍부한 데이터 확보
- 예: 파일1의 기본 정보 + 파일2의 상세 정보

### 3. 매칭 실패 데이터 (965건)
- 파일1의 정보만 보유
- 파일2의 추가 정보 없음
- 향후 데이터 수집 또는 다른 소스 활용 필요

---

## 📋 결합 데이터 활용 방안

### 1. 매칭 성공 데이터 (188건)
```python
# 매칭 성공 데이터만 필터링
matched_df = merged_df[merged_df['_merge'] == 'both']

# 파일2의 추가 정보 활용
# 예: 상세 진료 시간, 특수 서비스 등
```

### 2. 전체 데이터 활용
```python
# 전체 데이터 사용 (파일1 기준)
# 파일2 정보가 있으면 활용, 없으면 NULL

# 예: 파일2 정보 유무로 데이터 품질 구분
merged_df['has_detail'] = merged_df['_merge'] == 'both'
```

### 3. 매칭 실패 데이터 보완
```python
# 매칭 실패 데이터 확인
unmatched_df = merged_df[merged_df['_merge'] == 'left_only']

# 다른 매칭 방법 시도
# - 주소 일부만 사용
# - 전화번호 매칭
# - 좌표 기반 매칭 등
```

---

## ⚠️ 주의사항

### 1. 주소 매칭 실패
- 병원명 + 주소 매칭은 0건 (주소 형식 차이)
- 병원명만으로 매칭했으므로 **동명이병원 가능성** 존재
- 매칭 결과 검증 필요

### 2. 데이터 중복 가능성
- 병원명이 같지만 다른 병원일 수 있음
- 주소, 전화번호 등 추가 검증 권장

### 3. NULL 값 처리
- 매칭 실패 데이터는 파일2 컬럼이 모두 NULL
- 분석 시 NULL 처리 로직 필요

---

## 🔄 매칭률 개선 방안

### 1. 주소 정규화 강화
```python
# 도로명 주소 → 지번 주소 변환
# 상세 주소 제거
# 건물명 제거
# 예: "서울 강남구 역삼동 123-45"로 통일
```

### 2. 유사도 기반 매칭
```python
# Levenshtein Distance 사용
# 병원명 유사도 90% 이상 → 매칭
# 주소 유사도 80% 이상 → 매칭
```

### 3. 추가 매칭 키 활용
```python
# 전화번호 매칭
# 좌표(위도/경도) 매칭
# 요양기관번호 매칭
```

### 4. 수동 검증
```python
# 매칭 실패 데이터 중 중요 병원
# 수동으로 확인 및 매칭
```

---

## 📊 매칭 결과 통계

### 파일별 비교

| 항목 | 파일1 | 파일2 | 결합 후 |
|------|-------|-------|---------|
| 총 건수 | 1,153 | 1,103 | 1,153 |
| 매칭 성공 | - | - | 188 (16.3%) |
| 매칭 실패 | - | - | 965 (83.7%) |
| 컬럼 수 | 93 | 11 | 107 |

### 데이터 완성도

| 구분 | 건수 | 비율 | 설명 |
|------|------|------|------|
| **완전 데이터** | 188건 | 16.3% | 파일1 + 파일2 정보 모두 보유 |
| **부분 데이터** | 965건 | 83.7% | 파일1 정보만 보유 |

---

## ✅ 결론

### 매칭 결과
- **총 1,153건** 중 **188건(16.3%) 매칭 성공**
- 주소 형식 차이로 병원명만으로 매칭
- 매칭 실패 965건은 파일1 정보만 보유

### 데이터 활용
- 매칭 성공 데이터: 두 소스의 정보 결합 활용
- 매칭 실패 데이터: 파일1 정보만 활용
- 전체 데이터: 파일1 기준 완전성 유지

### 개선 필요
- 주소 정규화 강화
- 유사도 기반 매칭 도입
- 추가 매칭 키 활용

---

**리포트 작성**: 2026-01-20 00:02  
**작성자**: Data Integration System  
**버전**: 1.0
